function showToast(e,t){t=t||2e3;const o=document.getElementById("toast");document.getElementById("toast-message").textContent=e||"Attation",o.style.display="block",setTimeout(()=>{o.style.display="none"},t)}function showLoading(e,t){t=t||2e3;const o=document.getElementById("toastLoading");document.getElementById("toastLoading-message").textContent=e||"loading",o.style.display="block",setTimeout(()=>{o.style.display="none"},t)}function showOK(e,t){t=t||2e3;const o=document.getElementById("toastOK");document.getElementById("toastOK-message").textContent=e||"OK",o.style.display="block",setTimeout(()=>{o.style.display="none"},t)}function toggleEmojiDialog(){document.getElementById("emoji-dialog").classList.toggle("show")}function insertEmoji(e){document.getElementById("comment-content").value+=e,toggleEmojiDialog()}function changeLanguage(e,t){showOK(`${e}`),t=t||"/",window.location.href=t}function isValidIPv4(e){return/^(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])\.(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])\.(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])\.(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])$/.test(e)}function isValidIPv6(e){return/^([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}$/.test(e)}function queryIP(){showLoading("loading","1000");const e=document.getElementById("ip-input").value.trim();(isValidIPv4(e)||isValidIPv6(e))&&e?fetch(`/index.php?mod=iplookup&api=1&ip=${e}`).then(e=>e.json()).then(t=>{const o=`${t.location}`;document.getElementById("query-location").value=`${t.location}`,document.getElementById("query-latitude").value=`${t.latitude}`,document.getElementById("query-longitude").value=`${t.longitude}`,document.getElementById("query-result").style.display="block",saveQueryHistory(e,o),showOK("OK")}).catch(e=>{showToast("Failed")}):showToast("Invalid IP")}function saveQueryHistory(e,t){const o=JSON.parse(localStorage.getItem("queryHistory")||"[]"),n={time:(new Date).toLocaleString(),ip:e,location:t};o.unshift(n),o.length>10&&o.pop(),localStorage.setItem("queryHistory",JSON.stringify(o))}function copyToClipboard(e){document.getElementById(e).select(),document.execCommand("copy"),showOK("copied")}function toggleLanguageMenu(){document.getElementById("language-menu").classList.toggle("show")}async function submitReply(){const e=document.getElementById("reply-name").value.trim(),t=document.getElementById("reply-content").value.trim(),o=document.getElementById("captcha-input2").value.trim(),n=document.getElementById("reply-parentid").value.trim();if(!n)return void showToast("Invalid wish");if(!e)return void showToast("Type in your name");if(!t)return void showToast("Type in your reply");if(!o)return void showToast("Type in authcode");if(!await validateCaptcha(o))return void showToast("Invalid authcode");showLoading("",1e3);const a={name:e,comment:t,captcha:o,parentid:n};try{const e=await fetch("/index.php?mod=wishwall&action=insert",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),t=await e.json();t.success?(showOK("Replied. Will show once approved"),document.getElementById("reply-form").reset(),document.getElementById("captcha-image2").src="/logo.png"):showToast(t.message||"Failed")}catch(e){showToast(e)}showOK("Replied!"),hideReplyDialog(),document.getElementById("reply-name").value="",document.getElementById("reply-content").value=""}async function submitComment(){const e=document.getElementById("comment-name").value.trim(),t=document.getElementById("comment-email").value.trim(),o=document.getElementById("comment-content").value.trim(),n=document.getElementById("captcha-input").value.trim();if(!e)return void showToast("Type in your name");if(!o)return void showToast("Type in what you wish for");if(!n)return void showToast("Type in authcode");if(t&&!validateEmail(t))return void showToast("Invalid email");if(!await validateCaptcha(n))return void showToast("Invalid authcode");showLoading("loading","1000");const a={name:e,email:t,comment:o,captcha:n};try{const n=await fetch("/index.php?mod=wishwall&action=insert",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),i=await n.json();if(i.success){document.getElementById("comment-form").reset(),document.getElementById("captcha-image").src="/logo.png",saveComment({name:e,email:t,comment:o,time:(new Date).toLocaleString()}),showOK("Posted!"),renderComments()}else showToast(i.message||"Failed!")}catch(e){showToast(e)}}function saveComment(e){const t=JSON.parse(localStorage.getItem("comments")||"[]");t.unshift(e),localStorage.setItem("comments",JSON.stringify(t))}function renderComments(){const e=JSON.parse(localStorage.getItem("comments")||"[]");document.getElementById("comment-list").innerHTML=e.map(e=>`\n\t\t\t<div class="comment-card">\n\t\t\t\t<img src="/template/images/avatar.png" alt="avatar of myphoneip">\n\t\t\t\t<div class="comment-content">\n\t\t\t\t\t<div class="comment-header">\n\t\t\t\t\t\t<span class="comment-name">${e.name}</span>\n\t\t\t\t\t\t<span class="comment-time">${e.time}</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="comment-text">${e.comment}</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`).join("")}async function validateCaptcha(e){try{const t=await fetch("/index.php?mod=authimgCheck",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({captcha:e})});return(await t.json()).success}catch(e){return console.error("Invalid authcode",e),!1}}function validateEmail(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}async function gift(e){if(e)try{const t=await fetch("/index.php?mod=wishwall&action=gift",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({wishid:e})});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const o=await t.json();o.success?(showOK("Blessings sent!"),document.getElementById("gift"+e).innerText=o.message):showToast(o.message)}catch(e){return console.error("Network Error",e),showToast("Network Error"),!1}else showToast("Unknown error")}function showReplyDialog(e){const t=document.getElementById("reply-dialog");document.getElementById("reply-parentid").value=e,t.classList.add("show")}function hideReplyDialog(){document.getElementById("reply-dialog").classList.remove("show")}function toggleShareDialog(){document.getElementById("share-dialog").classList.toggle("show")}function shareToTwitter(){const e=encodeURIComponent(window.location.href),t=encodeURIComponent("what is my phone ip?");window.open(`https://twitter.com/intent/tweet?url=${e}&text=${t}`,"_blank")}function shareToFacebook(){const e=encodeURIComponent(window.location.href);window.open(`https://www.facebook.com/sharer/sharer.php?u=${e}`,"_blank")}function shareToLine(){const e=encodeURIComponent(window.location.href),t=encodeURIComponent("what is my phone ip?");window.open(`https://social-plugins.line.me/lineit/share?url=${e}&text=${t}`,"_blank")}function shareToWhatsApp(){const e=encodeURIComponent(window.location.href),t=encodeURIComponent("what is my phone ip?");window.open(`https://api.whatsapp.com/send?text=${t}%20${e}`,"_blank")}function shareToInstagram(){copyUrl()}function shareToSnapchat(){const e=encodeURIComponent(window.location.href),t=encodeURIComponent("what is my phone ip?");window.open(`https://www.snapchat.com/scan?attachmentUrl=${e}&text=${t}`,"_blank")}function shareToGoogle(){const e=encodeURIComponent(window.location.href);window.open(`https://plus.google.com/share?url=${e}`,"_blank")}function shareToTelegram(){const e=encodeURIComponent(window.location.href),t=encodeURIComponent("what is my phone ip?");window.open(`https://t.me/share/url?url=${e}&text=${t}`,"_blank")}function shareByEmail(){const e=window.location.href,t=encodeURIComponent("What is my phone ip address"),o=encodeURIComponent(`I found a super useful IP address lookup tool :${e}`);window.location.href=`mailto:?subject=${t}&body=${o}`}function copyUrl(){const e=window.location.href;navigator.clipboard?navigator.clipboard.writeText(e).then(()=>{showOK("copied")}).catch(()=>{fallbackCopyUrl(e)}):fallbackCopyUrl(e)}function fallbackCopyUrl(e){const t=document.createElement("textarea");t.value=e,t.style.position="fixed",document.body.appendChild(t),t.select();try{document.execCommand("copy")?showOK("copied"):showToast("copy failed")}catch(e){showToast("copy failed")}finally{document.body.removeChild(t)}}function scrollToTop(){window.scrollTo({top:0,behavior:"smooth"})}function toggleBackToTop(){const e=document.getElementById("back-to-top"),t=window.innerHeight,o=document.documentElement.scrollHeight,n=document.documentElement.scrollTop||document.body.scrollTop;o>t&&n>t/2?e.classList.add("show"):e.classList.remove("show")}function isPc(){var e=navigator.userAgent||navigator.vendor||window.opera;return!/windows phone|ipad|iphone|ipod|android|blackberry|mini|windows ce|palm/i.test(e)}function isNearBottom(e=240){const t=document.documentElement.scrollHeight;return(window.scrollY||document.documentElement.scrollTop)+window.innerHeight+e>=t}function getCurrentInfo(){fetch("/index.php?mod=iplookup&api=1").then(e=>e.json()).then(e=>{document.getElementById("current-ip").value=e.ip,document.getElementById("current-ipv6").value=e.ipv6,document.getElementById("current-location").value=`${e.location}`,document.getElementById("current-coordinates").value=`${e.latitude}, ${e.longitude}`,document.getElementById("current-browser").value=`${e.browser}`}),document.getElementById("current-browser").value=navigator.userAgent;const e=new Date;document.getElementById("current-time").value=e.toLocaleString()}function loadJS(e,t){const o=document.createElement("script");o.src=e,o.onload=t,o.onerror=function(){console.error("JS load failed")},document.body.appendChild(o)}window.addEventListener("scroll",toggleBackToTop);